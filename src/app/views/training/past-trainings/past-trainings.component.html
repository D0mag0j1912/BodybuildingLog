<ng-container *ngIf="!isError && (pastTrainings$ | async) as pastTrainings">
    <section class="main-section">
        <bl-past-trainings-filters
            (trainingEmitted)="searchEmitted($event)"></bl-past-trainings-filters>
        <ng-container *ngIf="!(isLoading$ | async); else loading">
            <mat-card class="card-info-wrapper">
                <mat-card-title class="week-title">
                    <strong class="week-title--txt">
                        {{ setTimePeriod(pastTrainings.dates) | async }}
                    </strong>
                    <span>
                        {{ ' (' + (pastTrainings.dates.startDate | date: 'dd.MM.yyyy') + ' - ' + (pastTrainings.dates.endDate  | date: 'dd.MM.yyyy') + ')' }}
                    </span>
                </mat-card-title>
                <div class="footer">
                    <div class="food-subtitle">
                        <strong class="food-subtitle--txt">
                            {{ ('common.food' | translate) + ': ' }}
                        </strong>
                        <span>{{ food + ' ' + ('common.kcal' | translate) }}</span>
                    </div>
                </div>
            </mat-card>
            <div
                *ngIf="pastTrainings.trainingsPerPage > 0; else noTrainings"
                class="training-item-wrapper"
                [class.no-trainings]="pastTrainings.trainingsPerPage === 0">
                <bl-training-item
                    *ngFor="let training of pastTrainings.trainings"
                    [training]="training"></bl-training-item>
            </div>
        </ng-container>
        <ng-template #loading>
            <div class="spinner-wrapper">
                <mat-spinner
                    class="spinner"
                    [diameter]="spinnerSize"></mat-spinner>
            </div>
        </ng-template>
    </section>
    <div class="training-paginator">
        <span class="training-paginator--label">
            {{ 'training.past_trainings.training_number' | translate }}
            <strong class="training-paginator--label-count">
                {{ pastTrainings.trainingsPerPage }}
            </strong>
        </span>
        <div class="training-paginator--button-wrapper">
            <div
                matTooltipPosition="above"
                matTooltipClass="tooltip"
                [matTooltip]="'training.past_trainings.buttons.previous_week' | translate">
                <button
                    mat-raised-button
                    type="button"
                    class="training-paginator--previous"
                    [disabled]="isLoading$ | async"
                    (click)="loadWeekTraining('Previous week')">
                    <mat-icon class="training-paginator--icon">navigate_before</mat-icon>
                </button>
            </div>
            <div
                matTooltipPosition="above"
                [matTooltip]="setNextWeekTooltip() | async"
                [matTooltipClass]="isNextWeekDisabled ? 'tooltip-error' : 'tooltip'">
                <button
                    mat-raised-button
                    type="button"
                    class="training-paginator--next"
                    [disabled]="isNextWeekDisabled || (isLoading$ | async)"
                    (click)="loadWeekTraining('Next week')">
                    <mat-icon class="training-paginator--icon">navigate_next</mat-icon>
                </button>
            </div>
        </div>
    </div>

    <ng-template #noTrainings>
        <section class="no-trainings">
            <h1 class="no-trainings-title">
                {{ 'training.past_trainings.no_trainings' | translate }}
            </h1>
            <button
                mat-raised-button
                class="no-trainings-button"
                type="button"
                routerLink="/training/new-training"
                color="primary">
                {{ 'training.past_trainings.log_training' | translate }}
            </button>
        </section>
    </ng-template>
</ng-container>

<ng-container *ngIf="!(isLoading$ | async) && isError">
    <div class="error-wrapper">
        <img
            class="error-image"
            src="../../../../assets/svgs/error1.svg">
        <h3 class="error-title">
            {{ 'training.past_trainings.errors.past_trainings_error_title' | translate }}
        </h3>
        <span class="error-description">
            {{ 'training.past_trainings.errors.past_trainings_error_description' | translate }}
        </span>
        <button
            mat-raised-button
            color="primary"
            type="button"
            (click)="tryAgain()">
            {{ 'common.try_again' | translate }}
        </button>
    </div>
</ng-container>
